<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Barrah Mullah Kandha Sporting Club</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root{
  --primary:#f26522;
  --secondary:#2f7d32;
  --dark:#1f2937;
  --light:#f4f6f8;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:"Segoe UI",sans-serif;
  background:var(--light);
  color:var(--dark);
}
header{
  background:linear-gradient(135deg,var(--primary),#ff9b63);
  color:#fff;
  padding:20px;
  text-align:center;
  font-size:22px;
  font-weight:600;
}
.container{
  max-width:480px;
  margin:auto;
  padding:16px;
}
.buttons{
  display:flex;
  gap:12px;
  margin:18px 0;
}
.buttons button{
  flex:1;
  padding:14px;
  border:none;
  border-radius:25px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
  color:#fff;
}
#admissionBtn{background:var(--secondary)}
#playersBtn{background:var(--primary)}

.section{
  display:none;
  background:#fff;
  border-radius:14px;
  padding:16px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}
.section.active{display:block}
.section h3{
  margin-top:0;
  font-size:18px;
  border-bottom:2px solid var(--light);
  padding-bottom:8px;
}
input{
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:1px solid #d1d5db;
  font-size:14px;
}
.submit-btn{
  background:var(--primary);
  margin-top:10px;
  width:100%;
  padding:14px;
  border:none;
  border-radius:25px;
  color:#fff;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
}

.total-badge{
  display:inline-block;
  background:var(--secondary);
  color:#fff;
  padding:6px 14px;
  border-radius:20px;
  font-size:14px;
  margin-bottom:12px;
}

.player-card{
  display:flex;
  gap:12px;
  padding:12px;
  margin-top:12px;
  border-radius:12px;
  background:#fff;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}
.player-card img{
  width:50px;
  height:65px;
  object-fit:cover;
  border-radius:4px;
  border:1px solid #ccc;
}
.player-info{
  flex:1;
  font-size:14px;
}
.player-info b{font-size:15px}

.player-number{
  font-weight:700;
  font-size:16px;
  color:var(--primary);
  margin-right:6px;
}

.card-actions{
  display:flex;
  gap:6px;
  margin-top:6px;
}

.card-actions button{
  width:32px;
  height:32px;
  border-radius:50%;
  padding:0;
  font-size:14px;
  border:none;
  cursor:pointer;
  color:#fff;
}

.info-btn{background:var(--secondary)}
.edit-btn{background:#2563eb}
.delete-btn{background:#dc2626}

#detailBox img{
  width:80px;
  height:100px;
  object-fit:cover;
  border-radius:6px;
  border:1px solid #ccc;
  display:block;
  margin-bottom:10px;
}
footer{
  margin-top:25px;
  padding:12px;
  background:var(--primary);
  color:#fff;
  text-align:center;
  font-size:14px;
}
</style>
</head>

<body>

<header>Barrah Mullah Kandha Sporting Club</header>

<div class="container">

<div class="buttons">
  <button id="admissionBtn">Admission</button>
  <button id="playersBtn">Players List</button>
</div>

<div id="admission" class="section active">
<h3>Admission Form</h3>
<input id="name" placeholder="Player Name">
<input id="father" placeholder="Father's Name">
<input id="address" placeholder="Address">
<input id="dob" type="date">
<input id="jersey" placeholder="Jersey Number">
<input id="position" placeholder="Position">
<input id="photo" type="file" accept="image/*">
<button id="submitBtn" class="submit-btn">Submit Admission</button>
</div>

<div id="players" class="section">
<h3>Players List</h3>
<input id="search" placeholder="Search by name / age / position" onkeyup="searchPlayer()">
<div id="playerList"></div>
</div>

<div id="details" class="section">
<h3>Player Information</h3>
<div id="detailBox"></div>
<button class="submit-btn" onclick="showPlayers()">Back to List</button>
</div>

</div>

<footer>Official Club Management Panel</footer>

<script>

let players = [];
let editingId = null;
const ADMIN_PASSWORD = "1234";

const firebaseConfig = {
  apiKey: "AIzaSyCkYMVn0Jh4Oo8Mgm8WyVAOVe65lSLGeks",
  authDomain: "barrahms-app.firebaseapp.com",
  projectId: "barrahms-app",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

document.getElementById("admissionBtn")
  .addEventListener("click",()=>showSection("admission"));

document.getElementById("playersBtn")
  .addEventListener("click",showPlayers);

document.getElementById("submitBtn")
  .addEventListener("click",submitPlayer);

function showSection(id){
  document.querySelectorAll(".section")
    .forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function submitPlayer(){

  const name = document.getElementById("name").value.trim();
  if(name===""){ alert("Player name required"); return; }

  let dob = document.getElementById("dob").value;
  let age = dob ? new Date().getFullYear() - new Date(dob).getFullYear() : "";

  let jersey = document.getElementById("jersey").value;

  if(!editingId){
    let duplicate = players.find(p=>p.jersey===jersey);
    if(duplicate){ alert("Jersey number already exists!"); return; }
  }

  let playerData = {
    name,
    father: document.getElementById("father").value,
    address: document.getElementById("address").value,
    dob,
    age,
    jersey,
    position: document.getElementById("position").value,
    admissionDate: new Date().toLocaleDateString()
  };

  let file = document.getElementById("photo").files[0];

  if(editingId){
    if(file){
      let reader = new FileReader();
      reader.onload = ()=>{
        playerData.photo = reader.result;
        db.collection("players").doc(editingId)
          .update(playerData)
          .then(()=>{ alert("Updated Successfully"); resetForm(); });
      };
      reader.readAsDataURL(file);
    }else{
      db.collection("players").doc(editingId)
        .update(playerData)
        .then(()=>{ alert("Updated Successfully"); resetForm(); });
    }
  }else{
    if(file){
      let reader = new FileReader();
      reader.onload = ()=>{
        playerData.photo = reader.result;
        db.collection("players").add(playerData)
          .then(()=>{ alert("Admission Successful"); resetForm(); });
      };
      reader.readAsDataURL(file);
    }else{
      db.collection("players").add(playerData)
        .then(()=>{ alert("Admission Successful"); resetForm(); });
    }
  }
}

function resetForm(){
  editingId = null;
  document.getElementById("submitBtn").innerText="Submit Admission";
  document.querySelectorAll("#admission input").forEach(i=>i.value="");
  loadPlayers();
  showPlayers();
}

function loadPlayers(){
  db.collection("players").get().then(snapshot=>{
    players = snapshot.docs.map(doc=>({id:doc.id,...doc.data()}));
    renderPlayers(players);
  });
}

function showPlayers(){
  showSection("players");
  loadPlayers();
}

function renderPlayers(list){

  const playerList = document.getElementById("playerList");

  playerList.innerHTML =
    `<div class="total-badge">
        Total Players: ${list.length}
     </div>`;

  list.forEach((p,i)=>{
    playerList.innerHTML += `
      <div class="player-card">
        ${p.photo?`<img src="${p.photo}">`:``}
        <div class="player-info">
          <span class="player-number">${i+1}.</span>
          <b>${p.name}</b><br>
          Age: ${p.age}<br>
          Jersey: ${p.jersey}<br>
          Position: ${p.position}

          <div class="card-actions">
            <button class="info-btn" onclick="showDetails(${i})">‚ÑπÔ∏è</button>
            <button class="edit-btn" onclick="editPlayer(${i})">‚úèÔ∏è</button>
            <button class="delete-btn" onclick="deletePlayer(${i})">üóëÔ∏è</button>
          </div>
        </div>
      </div>`;
  });
}

function showDetails(i){
  let p = players[i];
  const detailBox = document.getElementById("detailBox");

  detailBox.innerHTML = `
    ${p.photo?`<img src="${p.photo}">`:``}
    <b>Name:</b> ${p.name}<br>
    <b>Father:</b> ${p.father}<br>
    <b>Address:</b> ${p.address}<br>
    <b>DOB:</b> ${p.dob}<br>
    <b>Age:</b> ${p.age}<br>
    <b>Jersey:</b> ${p.jersey}<br>
    <b>Position:</b> ${p.position}<br>
    <b>Admission Date:</b> ${p.admissionDate}`;

  showSection("details");
}

function editPlayer(i){
  let pass = prompt("Admin password");
  if(pass!==ADMIN_PASSWORD){ alert("Wrong password"); return; }

  let p = players[i];
  editingId = p.id;
  showSection("admission");

  document.getElementById("submitBtn")
    .innerText="Update Player";

  document.getElementById("name").value=p.name;
  document.getElementById("father").value=p.father;
  document.getElementById("address").value=p.address;
  document.getElementById("dob").value=p.dob;
  document.getElementById("jersey").value=p.jersey;
  document.getElementById("position").value=p.position;
}

function deletePlayer(i){
  let pass = prompt("Admin password");
  if(pass!==ADMIN_PASSWORD){ alert("Wrong password"); return; }

  if(confirm("Are you sure to delete this player?")){
    db.collection("players")
      .doc(players[i].id)
      .delete()
      .then(()=>loadPlayers());
  }
}

function searchPlayer(){
  let v = document.getElementById("search").value.toLowerCase();
  renderPlayers(players.filter(p=>
    p.name.toLowerCase().includes(v)||
    p.position.toLowerCase().includes(v)||
    p.age.toString().includes(v)
  ));
}

</script>

</body>
</html>
